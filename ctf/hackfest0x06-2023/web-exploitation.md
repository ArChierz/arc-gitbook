Hackfest0x06 2023
==
Table of Content:

* [baby_inspect (Web)](#baby_inspect-(Web))
* [Bayi Template (Web)](#Bayi-Template-(Web))
* [Bayi LeFI (Web)](#Bayi-LeFI-(Web))
* [Undo it! (Rev)](#Undo-it!-(Rev))
* [Unicus (Crypto)](#Unicus-(Crypto))
* [ezRSA (Crypto)](#ezRSA-(Crypto))

## baby_inspect (Web)
![image](https://hackmd.io/_uploads/H1JXmS4iA.png)
The description told us that it may relate to some _inspect element_

![image](https://hackmd.io/_uploads/rkV4QB4iR.png)
The Website is like this, lets inspect the whole source code

![image](https://hackmd.io/_uploads/r1BB7rEjC.png)
in the div tag with class "**game-info**", there is a comment that gave a first bit of the flag, which is:

:::info 
(1/3) : **Hackfest0x06{c4N\_y0u\_**
:::

![image](https://hackmd.io/_uploads/BkuF7BVoC.png)
On Style Editor with **index.css**, look up on the lowermost of the program and I got the second bit flag.

:::info 
Flag (2/3) : **jUsT\_1nSp3ct\_**
:::

![image](https://hackmd.io/_uploads/SJ9TprNoA.png)
I look up on the **Debugger** tab, in the path **static->js** there were a javascript named **afaantuh.js** and I found the last bit of the flag.

:::info 
Flag (3/3) : **m3\_aNd\_f1nd\_M3}** 
:::

So, the whole flag is:

:::success
Flag = **Hackfest0x06{c4N\_y0u\_ jUsT\_1nSp3ct\_ m3\_aNd\_f1nd\_M3}**
:::


***

## Bayi Template (Web)
![image](https://hackmd.io/_uploads/ryGYm84j0.png)
In the description, it told that it just a simple calculator web app. So I open the link.

![image](https://hackmd.io/_uploads/SkB9X84iR.png)
The web app is look like this.

![image](https://hackmd.io/_uploads/BJE2m8EjA.png)
Next I try to look up from **inspect element** and search for header request. On the **Header Response,** I found interesting information which is **Server**. The server is use _**Werkzeug/2.2.2 Python/3.8.10.**_ Lets note this first.

![image](https://hackmd.io/_uploads/SJRp7L4o0.png)
* **Server: Werkzeug/2.2.2 Python/3.8.10**&#x20;
The server don't contain cookies, so the only information is about the server.

![image](https://hackmd.io/_uploads/SyYZ4L4jC.png)
I look up on the internet about **Werkzeug** and it related to **SSTI (Server Side Template Injection)**. I tried this website to looking for payload :

url: https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/werkzeug

url: https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection

![image](https://hackmd.io/_uploads/rJXBVUViA.png)
I found something interesting on the **Werkzeug** which is **Flask**, so I look into it and found another website:

url: https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask

**SSTI (Server Side Template Injection)** can be found through website that use **Werkzeug** server which is **Flask** that used **Python** programming language. The simple payload to test is:

```python
{{7*7}}
```
![image](https://hackmd.io/_uploads/SyouEL4sR.png)
![image](https://hackmd.io/_uploads/S1Cu4UVsC.png)
The payload work out and it reflect the value. So we can use this template **\{{ \}}** to exploit through the system.

![image](https://hackmd.io/_uploads/H1Wc4LVjR.png)
Next, use this payload and it reflect the value:

```python
{{config}}
```

Now, we gained some information:

* **Server: Werkzeug/2.2.2 Python/3.8.10**&#x20;
* **Use Jinja2 since \{{7\*7\}} work out**

![image](https://hackmd.io/_uploads/rJujEU4j0.png)
I looked up through internet and found some website that gave some payloads references:

url: https://kleiber.me/blog/2021/10/31/python-flask-jinja2-ssti-example/

![image](https://hackmd.io/_uploads/BkXp48ViC.png)
I use burpsuite and with this payload:


```python
{{‘tes’.__class__.__base__.__subclasses__()[92].__subclasses__()[0].__subclasses__()[0](‘flag.txt’).read()}} 
```

I finally spilled the flag, which is:


:::success
**Hackfest0x06{1\_l0v3\_Flask\_but\_1\_hate\_sn4ke\_\_it5\_call3d\_SSTI\_btw\_cheers}**
:::

<details>

<summary>Payload Explanation</summary>

**`{{‘tes’}}`** : gave output '**tes'** and the data type is **string(str).**

**`{{‘tes'.__class__}}`** : access **\_\_class\_\_** of **str.**

**`{{‘tes’.__class__.__base__}}`** : access **\_\_base\_\_** to know that class **object** available.

**`{{‘tes’.__class__.__base__.__subclasses__()}}` :** access **\_\_subclassess\_\_()** to list available subclasses for **object**.

**`{{‘tes’.__class__.__base__.__subclasses__()[92]}}` :** find class named **\_io.\_IOBase** to access Input/Output. It may vary but I found on it on index **92** (the output will reflect whether our class is exact match or not).

**`{{‘tes’.__class__.__base__.__subclasses__()[92].__subclasses__()[0]}}` :**  find class named **\_io.\_RawIOBase.**&#x20;

&#x20;**`{{‘tes’.__class__.__base__.__subclasses__()[92].__subclasses__()[0].__subclasses__()[0]}}` :** find class named **\_io.\_FileIO.** This used to access file using I/O.

**`{{‘tes’.__class__.__base__.__subclasses__()[92].__subclasses__()[0].__subclasses__()[0]('flag.txt').read()}}`** : use this class to grab object and read it and displayed it to the screen. use **('flag.txt').read()** to get and read file named **flag.txt** and show it to screen.&#x20;



</details>

***

## Bayi LeFI (Web)

![image](https://hackmd.io/_uploads/rJDavIVoA.png)
Based on the title, it indicate about **LFI** (Local File Inclusion). LFI is an attack technique in which attackers trick a web app into either running or exposing files on a web server [\[1\]](web-exploitation.md#1-https-brightsec.com-blog-local-file-inclusion-lfi-text-local-20file-20inclusion-20is-20an-xss-20an). With LFI, it can escalate to many ways such as expose sensitive information, XSS, and remote code execution.&#x20;

#### \[1]: [https://brightsec.com/blog/local-file-inclusion-lfi/#:\~:text=Local%20File%20Inclusion%20is%20an,XSS)%20and%20remote%20code%20execution.](https://brightsec.com/blog/local-file-inclusion-lfi/)

![image](https://hackmd.io/_uploads/SJcCv8EsA.png)
The webpage just show us something like this and tell us about LFI. There's 2 active link which one is:

![image](https://hackmd.io/_uploads/BkygdUVoC.png)
If I click one of it, It will gave query string with param name **gaskuen** and the value is **hola**. It will also reflected on the webpage as you can see in the middle.&#x20;

![image](https://hackmd.io/_uploads/rJoxuLVjC.png)
If I tried another link on the homepage, it will also gave query string with param name **gaskeun** and value **halo**. But, the value didn't reflect on the webpage. Something interesting part about the first link, so I open up again the first link to try enumerate on them.

![image](https://hackmd.io/_uploads/HkdWu84iR.png)
On the first link, I tried this payload `.../...//etc//passwd` to try bypass the blacklist, but nothing happened.&#x20;

![image](https://hackmd.io/_uploads/Sk0YYIEsC.png)
After a while tried to searching about LFI, I found this interesting article which says that may be it will work if I try **PHP Wrapper** that one of it have **PHP filter**.&#x20;

```html
php://filter
```

The concept is put a local file then encode with base64. To begin with it, here the payload:

```html
php://filter/convert.base64-encode/resource=hola
```

**hola** is the param value, I tried to send the request and the web reflect the base64 encode which is:

**encoded text:** SG9sYQ==

**decoded text:** Hola

With this, we know that the param value will reflect on the web page as an encoded text.&#x20;

Here the source about LFI and PHP Wrapper:

url:https://medium.com/@Aptive/local-file-inclusion-lfi-web-application-penetration-testing-cc9dc8dd3601

![image](https://hackmd.io/_uploads/SJ1ejINj0.png)
I tried to change the param value with **flag** and it gave another base64 encoded.

Payload:

```htmlembedded
?gaskeun=php://filter/convert.base64-encode/resource=flag`
```

**encoded text:** PD9waHAKCiRmbGFnID0gIkhhY2tmZXN0MHgwNntWdWxOM3JyX1czYl9TNGxhaF9zNFR1X055NF9ZNDRfTGZpfSI7

**decoded text:**

```php
<?php

$flag = "Hackfest0x06{VulN3rr_W3b_S4lah_s4Tu_Ny4_Y44_Lfi}";

```

:::success
**Hackfest0x06{VulN3rr\_W3b\_S4lah\_s4Tu\_Ny4\_Y44\_Lfi}**
:::

***
## Undo it! (Rev)

![image](https://hackmd.io/_uploads/BJlyYA84o0.png)

Pada challenge ini, mengharuskan saya untuk men-download file bernama chall.pyc. Sesuai deskripsi, .pyc merupakan file python yang telah ter-compile dan mengharuskan saya untuk melakukan decompile dan mengerti isi dari source code yang diberikan. 

Selanjutnya, saya mencoba untuk melakukan decompile dengan instalasi uncompyle6 pada CMD Windows dengan mengetik: pip install uncompyle6. Namun, saya tidak dapat menggunakan tool ini karena terdapat error. Selanjutnya, saya mencoba untuk menemukan decompiler online dan menemukan website:
https://www.toolnb.com/tools-lang-en/pyc.html yang dapat melakukan decompile file.

![image](https://hackmd.io/_uploads/SJATAINo0.png)

Setelah itu, file hasil decompile saya copy-paste ke program python baru dan saya beri nama undoit.py. Dari source code program, terdapat fungsi main(), fun00(), fun01(), fun02(), fun03(), fun04(), fun05(), fun06(), fun07(), fun08(), dan fun09() yang masing-masing mempunyai untaian string yang tidak berurutan. 

Saya mencoba untuk memperhatikan fungsi main() di mana pada line 2, saya diharuskan untuk men-input¬ password, dan algoritma akan memproses kalimat yang telah di-input seperti gambar berikut:

![image](https://hackmd.io/_uploads/SJR31wVsR.png)


Selanjutnya, saya memperhatikan fungsi yang bernama fun00() hingga fun09() yang terdapat untaian string. Saya mencoba untuk menggabungkan string sesuai dengan algoritma:
```python!
c = fun00(i[:3]) + fun01(i[3:6]) + fun02(i[6:9]) + fun03(i[9:12]) + fun04(i[12:15]) + fun00(i[15:18]) + fun01(i[18:21]) + fun05(i[21:24]) + fun06(i[24:27]) + fun07(i[27:30]) + fun00(i[30:33]) + fun08(i[33:36]) + fun09(i[36:39])
```

yang menyatakan bahwaa untai string dari fun00() + fun01()+fun02()+fun03()+fun04()+fun00()+fun01()+fun05()+fun06()+fun07()+fun00()+fun08()+fun09() 

akan menghasilkan untaian string dengan kalimat:
**c0mp1L3_tH3n_d3c0mp1L3_w1tH_uNc0mpyle_!**


![image](https://hackmd.io/_uploads/H1d8eD4sR.png)
![image](https://hackmd.io/_uploads/H1dDgDEs0.png)

Selanjutnya, saya coba jalankan program dan program meminta untuk melakukan input password. Saya masukkan kalimat: **c0mp1L3_tH3n_d3c0mp1L3_w1tH_uNc0mpyle_!**

Output yang dihasilkan menampilkan string Flag.

:::success
**Hackfest0x06{c0mp1L3_tH3n_d3c0mp1L3_w1tH_uNc0mpyle_!}**
:::
---

## UNIqueCODE (Foren)

![image](https://hackmd.io/_uploads/B15bZvNsR.png)

Pada challenge ini, disediakan file bernama chall.png dan deskripsi yang menyatakan bahwa ini merupakan random Unicode decrypting hidden file inside. Menyatakan bahwa adanya file tersembunyi di dalam file chall.png. file ini jika kita buka sekilas akan menampilkan gambar berupa teks Unicode. Di sini, Nampak tidak ada keanehan apapun, hanya sebatas teks random berpola.

![image](https://hackmd.io/_uploads/HyOG-wVjA.png)

Jika saya buka menggunakan Notepad, tidak ada hal yang spesial dari file ini.

![image](https://hackmd.io/_uploads/BkvmbDNoA.png)

![image](https://hackmd.io/_uploads/r14NbvNiC.png)

Selanjutnya, untuk mencari hidden file, saya menggunakan tool bernama Winrar dengan cara buka folder yang berisi file bernama chall.png (disini, file saya bernama chall (1).png ). Kemudian, klik kanan pada file chall (1).png dan akan muncul opsi Show archive contents, lalu saya klik opsi tersebut.

![image](https://hackmd.io/_uploads/ryodZDVoA.png)
Kemudian, akan muncul sebuah file bernama chall (1) dimana file ini tidak memiliki format file tertentu. Sebelum saya olah, saya lakukan ekstraksi ke folder yang sama dengan file chall (1).png. setelah itu, akan terbentuk folder bernama chall (1) yang berisi file bernama chall (1). Saya buka file tersebut menggunakan Notepad dan muncul teks asing yang kemungkinan merupakan kalimat encoded. 

![image](https://hackmd.io/_uploads/BJZobPNiC.png)

Terdapat kalimat unik  dimana ada barisan Unicode dan angka ditengahnya. Saya buka IDLE Python dan melakukan dugaan saya dimana angka 72 merupakan angka desimal pada ASCII. Saya menggunakan fungsi chr() dengan parameter 72 dan menghasilkan nilai ‘H’. kemudian saya coba lagi fungsi chr() kali ini parameternya 97 dan menghasilkan nilai ‘a’. saya berasumsi bahwa kalimat ini merupakan flag. 

![image](https://hackmd.io/_uploads/ryaT-vEsR.png)
:::success
**Flag = Hackfest0x06{y34h_y0u_c0mpl3tl3ly_d3crypt_th1s_ch4ll3ng3}**
:::

***
## StegCap

![image](https://hackmd.io/_uploads/rymfzvEi0.png)

Pada challenge terlihat dari deskripsi bahwa ada sesuatu yang rusak dan harus diperbaiki. File yang diberikan memiliki format dari tool Wireshark. 

![image](https://hackmd.io/_uploads/B1IBMP4sA.png)
Selanjutnya, saya lakukan sortir penggunaan Protocol, dan menemukan keunikan pada protokol HTTP terdapat data-data yang berisikan index.php, dan image. lalu, saya export file yang berada pada protokol HTTP untuk melihat isi file yang terkandung di dalamnya.

![image](https://hackmd.io/_uploads/rJNwMDEiA.png)

saya export file yang berada pada protokol HTTP untuk melihat isi file yang terkandung di dalamnya.


![image](https://hackmd.io/_uploads/HkgozDEsA.png)

Lalu saya menemukan satu file yang bernama **wUt_i$_tH1s.png** yang berisi QR Code.

![image](https://hackmd.io/_uploads/B170MDVjR.png)
Saya scan QR code menggunakan web zxing decoder online dan mendapatkan informasi dari QR code tersebut.

https://qr.codes/7fJE1k

Link ini men-direct saya ke suatu drive yang memiliki file bernama flag.png (saya menamai fflag.png) lalu saya download. Namun, file ini tidak bisa dibuka.

![image](https://hackmd.io/_uploads/rJlVXvEjR.png)

Kemudian, saya cek file ini menggunakan command file untuk memastikan isi dari file ini.
Namun, file ini menampilkan bahwa ia berisi data. Selanjutnya, saya coba extract kemungkinan adanya file tersembunyi dari file ini menggunakan tool steghide, namun menampilkan error bahwa file format tidak support.

![image](https://hackmd.io/_uploads/H1P87PVi0.png)
Selanjutnya saya coba untuk melihat metadata dari file ini dengan menggunakan command cat yang berfungsi untuk menyambungkan string yang tersedia pada file tersebut. Terdapat keanehan untuk file yang berformat .png namun awalannya bukan .png pada awalan string.

![image](https://hackmd.io/_uploads/Byq_XDEjR.png)

![image](https://hackmd.io/_uploads/rkaqQDNi0.png)

Selanjutnya, saya menggunakan tool zsteg untuk mendeteksi adanya file tersembunyi, namun ketika digunakan, terdapat error bahwa header pada file tidak mendukung.

Lalu, karena sebelumnya terindikasi masalah pada bagian header, saya mengambil sampel header dari file fflag.png menggunakan gabungan command xxd (hexdump) dan head (sample header). Dengan mengkomparasi file fflag.png dan **wUt_i$_tH1s.png** dapat diidentifikasi permasalahan header ini.

![image](https://hackmd.io/_uploads/HJkyVvVoA.png)

Di sini dapat kita lihat perbedaan header pada file yang sama-sama memiliki format .png.

![image](https://hackmd.io/_uploads/SkqxEvVi0.png)
Selanjutnya, saya melakukan manipulasi file dengan membuat file baru bernama fix.png yang dimasukkan dengan header dari file wUt_i$_tH1s.png sebanyak 16 bytes dan dimasukkan footer atau bagian terakhir dari file fix.png sebanyak 17 bytes dan ditambahkan ke file bernama fix.png.

![image](https://hackmd.io/_uploads/BJdMNDEoR.png)

Selanjutnya, saya mencoba untuk memainkan tone warna, brightness, hingga saya menemukan flag unik pada tangan roblox.

![image](https://hackmd.io/_uploads/SJjNVvNo0.png)

:::success
Flag = Hackfest0x06{pI3cE_0f_c4K3_iNNit_20221222}
:::

---
## Unicus (Crypto)
![image](https://hackmd.io/_uploads/H1LbldEoR.png)

Pada challenge ini, diberikan dua file bernama output.txt dan src.py (saya menamakan output.txt, output (1).txt dan src(1).py. Pada file bernama output.txt menampilkan sejumlah kalimat acak dan pada src.py menampilkan source code untuk melakukan decode dari teks kalimat. Dapat dilihat pada line 5, disini, untuk melakukan decode, menggunakan XOR dari variabel key. Saya tidak tahu berapa angka pasti dari variabel tersebut.

![image](https://hackmd.io/_uploads/r1hfgOVjA.png)![image](https://hackmd.io/_uploads/BJ_QgO4s0.png)

Maka dari itu, saya melakukan modifikasi pada file dan membuat file baru bernama flag.py yang berisi mengenai pembacaan file dan angka random.

![image](https://hackmd.io/_uploads/ByxSl_EsR.png)
![image](https://hackmd.io/_uploads/ByLHgd4oC.png)

Ketika program di run, maka hasil akan dimasukkan ke dalam file output.txt dan terlihat pada output.txt flag dari challenge ini.
:::success
Flag = **Hackfest0x06{tW1nkl3_tw1NkL3_s1n6l3_ByTe_x0RRR}**
:::

***
## ezRSA (Crypto)
![image](https://hackmd.io/_uploads/rk32eO4jA.png)

Pada challenge ini diberikan file bernama ez.txt yang berisi nomor2 dan angka seperti n, ciphertext, dan e. n merupakan modulus, ciphertext merupakan kalimat yang telah didekripsi, dan e merupakan eksponen publik.

![image](https://hackmd.io/_uploads/H10TeOEj0.png)
Di sini, saya menggunakan tool yang bernama RsaCtfTool dengan melakukan running file yang berupa python.

![image](https://hackmd.io/_uploads/r1nl-ONsA.png)
Setelah menunggu beberapa saat, hasil dari dekripsi yang berasal dari utf-8 dan STR memberikan Flag.
![image](https://hackmd.io/_uploads/ryBfb_EjR.png)

:::success
**Hackfest0x06{h4ppY_n3w_y3aRR!!th1s_iS_R1v3sT_sHaM1R_AdL3m4N_3nCryPt10N}**
:::